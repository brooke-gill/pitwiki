<!DOCTYPE html>
<html> 
<head>
<link rel="stylesheet" href="stylesheet.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pit Markdown - The Hypixel Pit Wiki</title>
<meta name="description" content="">
<meta name="author" content="BrookeAFK">
<meta name="keywords" content="">
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/x-icon" href="./favicon/favicon.ico">
<link rel="manifest" href="./favicon/site.webmanifest">
<script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.9.0/showdown.min.js"></script>

<p style="text-align: center">
<label for="textarea">Hypixel Pit Markdown Editing</label><br>
<textarea id="htmlraw" style="width: 90%; height: 300px; font-size: 16px"></textarea><br>
<textarea id="htmloutput" style="width: 90%; height: 100px; font-size: 16px"></textarea><br>
</p>
<p id="htmlpaste" style="width: 100%;">Press any key to update the HTML!</p>
<br><br>
<p>quick styles:</p>
<pre><code style="background-color: #252525;">{a|<span style="color: #5f5">text</span>}

title: My Title

author: Me

**bold**, *italics*

`some code`

[box|box_width_percent|image_link|image_width_percent|caption]

|This|is|how|
|---|---|---|
|to|make|a|
|table|with|[links\|gold]|
|and|{55C1E8|custom}|{d|colors}|

- list
- of
- things

<span class="m0">0</span> <span class="m1">1</span> <span class="m2">2</span> <span class="m3">3</span> <span class="m4">4</span> <span class="m5">5</span> <span class="m6">6</span> <span class="m7">7</span> <span class="m8">8</span> <span class="m9">9</span> <span class="ma">a</span> <span class="mb">b</span> <span class="mc">c</span> <span class="md">d</span> <span class="me">e</span> <span class="mf">f</span></code></pre>
<script>
var title, author, keywords, intro;
var topimage = "";

function updateIntro() {
    intro = `<!DOCTYPE html>
<!-- Generated by Pit Markdown: https://pit.wiki/PitMD -->
<html> 
<head>
<link rel="stylesheet" href="stylesheet.css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>` + title + ` - The Hypixel Pit Wiki</title>
<meta name="description" content="">
<meta name="author" content="` + author + `">
<meta name="keywords" content="` + keywords + `">
<link rel="apple-touch-icon" sizes="180x180" href="./favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="./favicon/favicon-32x32.png">
<link rel="icon" type="image/x-icon" href="./favicon/favicon.ico">
<link rel="manifest" href="./favicon/site.webmanifest">
\u003cscript src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous">\u003c/script>
\u003cscript> 
$(function(){
  $("#header").load("header.html"); 
  $("#footer").load("footer.html"); 
});
\u003c/script>
</head>
<body>
<div id="header"></div>
<div class="box">
<span class="body">` + topimage + `<span class="header">` + title + `</span><br>
<span class="subheader">From the <a href="./">Hypixel Pit Wiki</a></span><br><hr>`
}

var outro = `</span></div>
<div id="footer"></div>
</body>
</html>`

var example = `title: Pit Wiki Markdown

author: BrookeAFK

[tbox|30|Look at tbox!|banner_smaller.png|100|{f|Image boxes! How wonderful!}]

**Welcome** to Pit Wiki editing in a modified version of [Markdown](https://en.wikipedia.org/wiki/Markdown)! We hope you find this easier than editing the raw HTML text.

Here's some new features that PitMarkdown has that Markdown doesn't:
- **Easy-to-add special links**, like [XP], [gold], and [renown]. [Prestiging](Prestige) requires [65,950 XP|xp]. The [Barbarian](Perks#Barbarian) axe deals 4[heart] of damage.
- **Color codes** using curly brackets: { and \\}. They follow the standard Minecraft order, starting at {0|black}. {1|Then,} {2|they} {3|move} {4|between} {5|every} {6|color} {7|code} {8|in} {9|between}, {a|sixteen} {b|in} {c|total}, {d|before} {e|reaching} {f|white}. Custom color codes can be added with a hex code, such as {F8B1F1|this}. True damage is {td|also here}.

If you need to insert regular HTML tags, you can do that as well. <span class="subheader">**Markdown** still works inside them!</span> HTML entities, such as &uarr; and &star;, also work.
[box|20|map_seasons_winter.png|100]

Images can be easily made in a table on the right with [box]. The arguments are as follows:
1. Width of box (roughly the % of the screen)
2. Image location
3. Width of image (typically \`100\` or \`50\`)
4. Caption (optional&mdash;leave this out if you don't want one!)

Tables are supported, too; they're just like regular Markdown.
|Name|Description|Cost|
|---|---|---|
|Flameborn|Sets your sword ablaze, dealing {c|+50% damage} every hit.|[50 renown\\|renown]|
|Frosted Fury|Tips your arrows in ice, giving players Slowness II (0:04) on contact.|[5,000,000g\\|gold]|
|Duplication Glitch|Instantly gain [7 XP\\|XP].|[6 XP\\|XP]|


The Pit Wiki Markdown Editing is based on Showdown. Read more [here](http://demo.showdownjs.com/).`

document.getElementById('htmlraw').value = example;

function format() {
    showdown.setOption('tables', 'true');
var converter = new showdown.Converter(); //converts MD to HTML
var text = htmlraw.value; //gets markdown from input
title = (text.match(/title: .*/i))
author = (text.match(/author: .*/i))

if(title !== undefined && title !== null) { // if title exists
    title = title[0].substring(7); // remove "title: "
    keywords = "Hypixel Pit Wiki, Pit " + title + ", Hypixel, " + title + ", Hypixel Pit " + title;
} 
updateIntro();
text = text.replace(/\[box\|(\d+?)\|(.+?)\|(\d+?)\|(.+?)\]/gi,`<table class="item body" style="width: calc($1 * 10px)"><tr><td style="text-align: center"><img src="./images/$2" width="$3%"></td></tr><tr><td style="text-align: center" class="small">$4</td></tr></table>`)
text = text.replace(/\[box\|(\d+?)\|(.+?)\|(\d+?)\]/gi,`<table class="item body" style="width: calc($1 * 10px)"><tr><td style="text-align: center"><img src="./images/$2" width="$3%"></td></tr></table>`)
text = text.replace(/\[tbox\|(\d+?)\|(.+?)\|(.+?)\|(\d+?)\]/gi,`<table class="item body" style="width: calc($1 * 10px)"><tr><td class="tableheader">$2</td></tr><tr><td style="text-align: center"><img src="./images/$3" width="$4%"></td></tr></table>`)
text = text.replace(/\[tbox\|(\d+?)\|(.+?)\|(.+?)\|(\d+?)\|(.+?)\]/gi,`<table class="item body" style="width: calc($1 * 10px)"><tr><td class="tableheader">$2</td></tr><tr><td style="text-align: center"><img src="./images/$3" width="$4%"></td></tr><tr><td style="text-align: center" class="small">$5</td></tr></table>`)
text = text.replace(/\[heart\]/gi,'â™¥&#xFE0E;')
text = text.replace(/\{([0123456789ABCDEF])\|/gi,`<span class="m$1">`)
text = text.replace(/\{td\|/gi,`<span class="td">`)
text = text.replace(/\{([0123456789ABCDEF]{6})\|/gi,`<span style="color: #$1">`)
text = text.replace(/([^\\])\}/g,`$1</span>`)

text = converter.makeHtml(text); // converts the MD to HTML

text = text.replace(/\[XP\]/gi,`<a href="XP"><span class="mb">XP</span></a>`)
text = text.replace(/\[gold\]/gi,`<a href="Gold"><span class="m6">gold</span></a>`)
text = text.replace(/\[renown\]/gi,`<a href="Renown"><span class="me">renown</span></a>`)
text = text.replace(/\[(.+?)\|XP\]/gi,`<a href="XP"><span class="mb">$1</span></a>`)
text = text.replace(/\[(.+?)\|gold\]/gi,`<a href="Gold"><span class="m6">$1</span></a>`)
text = text.replace(/\[(.+?)\|renown\]/gi,`<a href="Renown"><span class="me">$1</span></a>`)
text = text.replace(/<p>title: .*<\/p>{0,1}/gi,'')
text = text.replace(/<p>author: .*<\/p>{0,1}/gi,'')



var html = intro + text + outro;
htmloutput.value = html;
htmlpaste.innerHTML = html;
}

format();

document.onkeyup=function(e){
    format();
};

</script>